import pandas as pd


def generate_bibtex(row):
    """
    Functie om een BibTeX-vermelding te genereren voor een rij in de CSV-data.
    """
    bibtex_entry = f"@MISC{{CVE-{row['cve']},\n"
    bibtex_entry += f"  title = {{{row['Title']}}},\n"
    bibtex_entry += f"  howpublished = \"Available from MITRE, CVE-ID {row['cve']}.\",\n"
    bibtex_entry += f"  month = {row['published'].split('-')[1]},\n"
    bibtex_entry += f"  year = {{{row['published'].split('-')[0]}}},\n"
    bibtex_entry += f"  url = {{http://cve.mitre.org/cgi-bin/cvename.cgi?name={row['cve']} }},\n"
    bibtex_entry += "  urldate = {Unknown}\n"  # Geen specifieke datum voor 'urldate' in de dataset
    bibtex_entry += "}\n\n"
    return bibtex_entry


def generate_bibtex_for_all_rows(csv_file_path, output_file_path):
    """
    Leest een CSV-bestand en genereert een BibTeX-bestand met vermeldingen voor elke rij.
    """
    vulnerabilities_df = pd.read_csv(csv_file_path)
    bibtex_entries = vulnerabilities_df.apply(generate_bibtex, axis=1)

    with open(output_file_path, 'w') as bibfile:
        for entry in bibtex_entries:
            bibfile.write(entry)


# Pad naar het CSV-bestand en de locatie waar het BibTeX-bestand moet worden opgeslagen
input_file_path = 'path/to/vulnerabilities.csv'
output_bibtex_file = 'path/to/references.bib'

# Het genereren van het BibTeX-bestand
generate_bibtex_for_all_rows(input_file_path, output_bibtex_file)
